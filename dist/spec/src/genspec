#!/bin/csh -f

#
# path of the C preprocessor
#
set CPPFLAGS=" -x c-header -E"
set CPPNAME=`which gcc`
set CPP="$CPPNAME$CPPFLAGS"

#
# check argument count
#
if ( $# != 4 ) then
  echo "usage : genspec basename language path-to-parser"
  exit 1
endif

#
# path of the test_parser program
#
set PARSER="$4"

#
# check if CPP can be found
#
if ( `filetest -x $CPPNAME` == 0 ) then
  echo "genspec: cannot find preprocessor: $CPP"
  echo "genspec: set CPP variable in genspec script"
  exit 1
endif

#
# check if PARSER can be found
#
if ( `filetest -x $PARSER` == 0 ) then
  echo "genspec: cannot find parser"
  echo "genspec: set PARSER variable in genspec script"
  exit 1
endif

#
# call parser
#
$CPP -P $1 | $PARSER $2 $3

exit 0
